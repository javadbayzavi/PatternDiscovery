@model List<discovery.Models.filelistview>
<div class="card">
    <div class="card-header">
        <h3> Load remote data files</h3>
    </div>
    <form action="~/dataset/LoadRemoteFileList" method="post">
        @Html.AntiForgeryToken()
        <div class="card-body">
            <div class="form-group">
                <label class="form-control">Enter url:</label>
                <input type="text" class="form-control" name="url" />
                <span class="text-info">
                    <i>
                        Default url : https://mail.python.org/pipermail/python-dev/
                        Valid formats: txt, csv
                    </i>
                </span>
            </div>
        </div>
        <div class="card-footer">
            <div class="form-group">
                <input type="submit" value="Load" class="btn-primary" />
            </div>
        </div>
    </form>
</div>
<!-- DataTables -->
<link rel="stylesheet" href="~/scripts/plugins/datatables-bs4/css/dataTables.bootstrap4.min.css">
<link rel="stylesheet" href="~/scripts/plugins/datatables-responsive/css/responsive.bootstrap4.min.css">
<link rel="stylesheet" href="~/scripts//plugins/datatables-buttons/css/buttons.bootstrap4.min.css">
<div class="card">
    <div class="card-header">
        <h3 class="card-title">Remote File List</h3>
    </div>
    <!-- /.card-header -->
    <div class="card-body">
        <table id="patterntbl" class="table table-bordered table-hover table-striped">
            <thead>
                <tr>
                    <th>
                        #
                    </th>
                    <th>
                        File Name
                    </th>
                    <th>
                        Url
                    </th>
                    <th> Download</th>
                </tr>
            </thead>

            <tbody>
                @{ 
                    int index = 1;
                    var files = (Model != null) ? Model.ToList() : new List<discovery.Models.filelistview>();
                }
                @foreach (var item in files)
                {
                    <tr>
                        <td>
                            @(index++)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.filename)
                        </td>
                        <td>
                            <a href="
                            @Html.DisplayFor(modelItem => item.fileurl)
                               ">
                                @Html.DisplayFor(modelItem => item.fileurl)
                            </a>
                        </td>
                        <td>
                            <a href="@(item.fileurl)" title="Download @(item.filename)"><i class="fa fa-save" aria-hidden="true"></i></a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <!-- /.card-body -->
</div>
<!-- /.card -->

@*Download form appears to hit only files fetched from remote url*@
@if(files.Count > 0)
{ 
<div class="row">
    <div class="col">
        <form action="~/dataset/FetchRemoteFiles" method="post">
            <div class="form-group">
                <input type="submit" value="Download All" class="form-control btn-primary" />
            </div>
        </form>
    </div>
</div>
}
<script src="~/scripts/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="~/scripts/plugins/datatables-bs4/js/dataTables.bootstrap4.min.js"></script>
<script src="~/scripts/plugins/datatables-responsive/js/dataTables.responsive.min.js"></script>
<script src="~/scripts/plugins/datatables-responsive/js/responsive.bootstrap4.min.js"></script>
<script src="~/scripts/plugins/datatables-buttons/js/dataTables.buttons.min.js"></script>
<script src="~/scripts/plugins/datatables-buttons/js/buttons.bootstrap4.min.js"></script>
<script src="~/scripts/plugins/jszip/jszip.min.js"></script>
<script src="~/scripts/plugins/pdfmake/pdfmake.min.js"></script>
<script src="~/scripts/plugins/pdfmake/vfs_fonts.js"></script>
<script src="~/scripts/plugins/datatables-buttons/js/buttons.html5.min.js"></script>
<script src="~/scripts/plugins/datatables-buttons/js/buttons.print.min.js"></script>
<script src="~/scripts/plugins/datatables-buttons/js/buttons.colVis.min.js"></script>
<script>
    $(function () {
        $("#patterntbl").DataTable({
            "responsive": true,
            "lengthChange": false,
            "autoWidth": false,
            "buttons": ["copy", "csv", "excel", "pdf", "print", "colvis"],
            "paging": true,
            "searching": true,
            "ordering": true,
            "info": true,
        }).buttons().container().appendTo('#patterntbl_wrapper .col-md-6:eq(0)');
    });
</script>
